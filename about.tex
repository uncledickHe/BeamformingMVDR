\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[cp1251]{inputenc}  %% 1
\usepackage[T2A]{fontenc}      %% 2
\usepackage[english, russian]{babel}    %% 3
\usepackage{amsmath}
\usepackage{biblatex}
\addbibresource{biblio.bib}

\title{Обработка сигнала фазированной антенной решеткой. Метод MVDR.}
\author{Яцкин Данил}

\begin{document}

\maketitle

\section{Введение.}
 
В настоящей  статье рассматривается один из методов оптимальной обработки плосковолнового сигнала, принимаемого фазированной антенной решеткой (ФАР) при наличии шумового поля. Метод носит название MVDR.
 
Сама аббревиатура расшифровывается как \textit{minimum variance distortionless response (неискаженный отклик с наименьшей дисперсией)}. Как следует из названия, метод обеспечивает минимальную дисперсию несмещенной ошибки  волновой формы сигнала. В работе \cite{Trees2002} показано, что данное требование оказывает действие, равносильное действию неискажающего фильтра, минимизирующего дисперсию на выходе. Отдельно доказано, что если шум является гауссовским процессом, выходной сигнал оптимального неискажающего фильтра соответствует максимальной оценке правдоподобия формы сигнала.

Шум в рамках данного метода рассматривается как случайный процесс с известной статистикой второго порядка. Принимаемый сигнал неизвестен, однако известно направление на его источник. При этом стоит обратить отдельное внимание на то, что метод MVDR работает только для плосковолновых сигналов, не являющихся случайными.






\section{Физические основы метода}

Алгоритм MVDR способен качественно подавлять помехи, но для этого, как правило, требуется высокое значение соотношения "сигнал-шум". При этом реализация алгоритма существенным образом зависит от векторов управляющих воздействий и, в том числе, от угла падения принимаемого сигнала по отношению к элементу антенны.

Сигнал $X(\omega)$ в частотной области представляет из себя сумму исходного сигнала и шума:

\begin{center}
$X(\omega) = X_{S}(\omega) + N(\omega)$
\end{center}

Антенная решетка осуществляет обработку сигнала. Для этого каждому элементу решетки присваивается свой весовой коэффициент $w_i(\omega)$, при этом коэффициенты образуют матрицу $W(\omega)$. Суть метода MVDR кроется в расчете матрицы $W(\omega)$. Стоит отметить, что эта матрица расчитывается отдельно для каждого сигнала в зависимости от разных параметров, среди которых и направление сигнала. Соответстенно, строго говоря, она зависит от пришедшего сигнала, но для простоты записи эта зависимость не будет указаваться далее и матрица будет обозначаться просто $W(\omega)$ - считая, что она рассматривается и вычисляется для конкретного пришедшего сигнала. Результирующий сигнал, получаемый после обработки, представляет из себя суперпозицию сигналов, обработанных на всех элементах решетки.

Тогда вектор неискаженного сигнала может быть записан как
\begin{equation}
X_{S}(\omega) = F(\omega)a(\omega),
\end{equation}


Здесь $F(\omega)$ -- снимок сигнала в частотной области, а $a(\omega)$ -- управляющий вектор для решетки, определяемый как параметрами самой решетки, так и параметрами пришедшего сигнала. 
В работе \cite{Kiong2014} показано, что $a(\omega)$ для конкретного пришедшего сигнала следует рассматривать как управляющий вектор, соответствующий направлению отклика, то есть наиболее корректной записью является представление этого вектора в виде:

\begin{equation}
a(\omega) \equiv a(\theta) = \begin{bmatrix} 1 \\ exp(j \frac{\omega d}{c} sin\theta_i) \\ exp(j(m-1) \frac{\omega d}{c} sin\theta_i) \end{bmatrix},
\end{equation}

где m -- число элементов решетки, c -- скорость распространения сигнала в рассматриваемой среде, $\theta_i$ - направление i-ого сигнала, а d - расстояние между элементами решетки.

Что касается шума, то он, как уже было сказано ранее, рассматривается здесь как случайный вектор с нулевым средним, а значит его его спектральная матрица записывается в следующем виде:

\begin{equation}
S_n(\omega) = S_c(\omega) + \sigma_{\omega}^{2}I
\end{equation}

Здесь $I$ - единичная матрица, а $\sigma_{\omega}^{2}$ - соответстующая дисперсия.

\section{Математическая реализация метода}

Итак, процесс преобразования сигнала записывается в виде
\begin{equation}
Y(\omega) = W^H(\omega)X(\omega),
\end{equation}

где $W^{H}(\omega)$ -- эрмитово-сопряженная мартица для $W(\omega)$.

Для достижения условий метода требуется одновременное выполнение двух критериев

1. Критерий неискаженности. \cite{Brown62}

2. Критерий минимальной дисперсии несмещенной оценки. \cite{Levin64}

\paragraph{3.1. Критерий неискаженности\\}
Для выполнения данного критерия необходимо, чтобы в отсутствии шума для любых $F(\omega)$ выполнялось

\begin{center}
$F(\omega) = Y(\omega)$
\end{center}

При таком ограничении можно минимизировать дисперсию $Y(\omega)$ и в присутствии шума тоже. Соответственно, можно представить этот сигнал в виде

\begin{equation}
Y(\omega) = F(\omega) + Y_{n}(\omega)
\end{equation}

При таком рассмотрении можно сделать вывод о необходимости минимизации среднеквадратичной оценки выходного шума, задаваемого формулой

\begin{equation}
E[|Y_{n}(\omega)|^{2}] = W^{H}(\omega)S_{n}(\omega)W(\omega)
\end{equation}

Необходимо ввести также ограничение, определяющее отсутствие искажений:

\begin{equation}
W^{H}(\omega)a(\omega) = 1
\end{equation}

Соответственно, выполнение данного критерия заключается в минимизации выражения (6) при выполнении условия (7). 

\paragraph{3.2. Критерий минимальной дисперсии несмещенной оценки\\}

Условия выполнения этого критерия предполагают, что $Y(\omega)$ -- несмещенная оценка с минимальной дисперсией для $F(\omega)$ 

Это подразумевает, что
$E[Y(\omega)] = F(\omega)$, или, при учете (5) для любого $F(\omega)$ выполняется:

\begin{equation}
E[Y(\omega)] = E[F(\omega)] + E[N(\omega)] = E[F(\omega)]
\end{equation}

Стоит отметить, что здесь также подразумевается выполнение условия (7).

\paragraph{3.3. Решение задачи минимизации\\}

Итак, необходимо минимизировать функцию $E[|Y_{n}(\omega)|^{2}] = W^{H}(\omega)S_{n}(\omega)W(\omega)$ при условии (ограничении) $W^{H}(\omega)a(\omega) = 1$.

Для решения задачи минимизации применим метод Лагранжа. Обозначив множителя Лагранжа $\lambda(\omega)$, получаем:

\begin{equation}
L = W^{H}(\omega)S_{n}(\omega)W(\omega) + \lambda(\omega)[W^{H}(\omega)a(\omega) - 1] + \lambda^{*} (\omega)[W^{H}(\omega)a(\omega) - 1]
\end{equation}

Применяя комплексный градиент, получаем, что

\begin{center}
\begin{cases}

$W_{0}^{H}(\omega) = -\lambda(\omega)a^{H}(\omega)S^{-1}_{n}(\omega)$,\\

$\lambda(\omega) = - [a^{H}(\omega)S^{-1}_{n}(\omega)a(\omega)]^{-1}$
\end{cases}
\end{center}

Итоговое решение записывается как:

\begin{equation}
W_{0}^{H}(\omega) = \frac{a^{H}(\omega)S^{-1}_{n}(\omega)}{a^{H}(\omega)S^{-1}_{n}(\omega)a(\omega)}
\end{equation}

Такой вид обработки луча впервые ввел Капон \textit{(J. Capon)} \cite{Capon69} и в литературе можно найти упоминания похожих методов, связываемых именно с этой фамилией.

Мы можем оценить и найти все параметры, если будет знать, что из себя представляет $S_{n}(\omega)$
В работе \cite{VV88} доказано взаимно однозначное соответствие между $S_{n}(\omega)$ и пространственной ковариационной матрицей $R$ при условии того, что шум является случайным процессом.

Пространственная ковариационная матрица состоит из дисперсий данных каждого элемента антенны (по диагонали) и попарных ковариаций данных на всех элементах.

\section{Принципы реализации}

\textbf{Входные параметры}

\begin{tabular}{c|c}
\hline
\textit{H} & объект \\
\hline
\textit{X} & входной сигнал \\
\hline
$X_T$ & шаблоны для настройки \\
\hline
\theta & угол (направление)  \\
\hline


\end{tabular}\\

\textit{H} и \textit{X} являются обязательными для задания параметрами, $X_T$ и $\theta$ могут отдельно не определяться.

\textit{H} содержит в себе данные, характеризующие рассматриваемую решетку (количество и расположение сенсоров, расстояние между ними \textit{(может быть вычислено исходя из расположения)}, частота дискретизации), среду (скорость распространения сигнала) и источник сигнала ($\theta$, а возможно, и расположение самого источника).

\textit{X} в общем случае представляется в виде матрицы, число строк в которой равно числу подрешеток антенной решетки (при наличии таковых - для рпиема других сигналов). Число столбцов, соответственно, рано числу элементов в этих подрешетках. Если решетка не разбита на подрешетки, то  \textit{X} представляет из себя строку.

$X_T$ представляется в аналогичном \textit{X} виде (см. выше).

$\theta$ задается, как правило, в азимутальной системе координат.\\


\textbf{Выходные параметры}

\begin{tabular}{c|c}
\hline
\textit{Y} & преобразованный сигнал \\
\hline
\textit{W} & формирующие веса \\
\hline



\end{tabular}


И \textit{Y}, и \textit{W} представляются в виде матриц, число строк в которых равно числу подрешеток (при наличии таковых), а число столбцов - числу направлений формирования луча.


Соответственно, результирующий массив \textit{Y} выражается через исходный (\textit{X}) формулой 

\begin{equation}
Y = W^H X,
\end{equation}

где $W^H$ -- эрмитово-сопряженная мартица для W.

При известном направлении полезного сигнала следует минимизировать выходную мощность. Мощность выражается следующим образом:

%\begin{equation}
\begin{center}
$P = \{E|Y|^2\} = E\{W^H X X^H W\} = W^H E\{X X^H W\} = W^H R,$
\end{center}
%\end{equation}

где R - ковариационная матрица для X.\\ 

Соответственно, оптимальные веса выбираются именно для минимизации выходной мощности при сохранении единичного усиления в соответствующем направлении $a(\theta) \equiv a(\omega)$, что является вектором управления для решетки при рассмотрении конкретного сигнала.

Адаптивный алгоритм MVDR можно записать следующим образом:

\begin{equation}
min_W \{W^H R W\} \text{  }\text{  } \text{  }\text{  }\text{          при условии } W^H a(\theta) = 1
\end{equation}

Оптимизация весовых коэффициентов может быть записана  формулой:

\begin{equation}
W=\frac{R^{-1}a(\theta)}{a^H(\theta)R^{-1}a(\theta)}
\end{equation}

Формулы (11) и (13) в конечном счете и определяют метод MVDR.

\printbibliography

\end{document}
